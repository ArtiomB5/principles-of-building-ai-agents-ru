# 28
## ТЕКСТОВЫЕ ОЦЕНКИ

Текстовые оценки могут казаться немного похожими на то, как аспирант-ассистент оценивает вашу домашнюю работу по рубрике. Они будут немного педантичными, но обычно не без оснований.

### **Точность и надежность**

Вы можете оценивать, насколько правильны, правдивы и полны ответы вашего агента. Например:

*   **Галлюцинации.** Содержат ли ответы факты или утверждения, отсутствующие в предоставленном контексте? Это особенно важно для RAG-приложений.
*   **Достоверность.** Точно ли ответы представляют предоставленный контекст?
*   **Сходство содержания.** Содержат ли ответы согласованную информацию в различных формулировках?
*   **Полнота.** Включают ли ответы всю необходимую информацию из ввода или контекста?
*   **Релевантность ответа.** Насколько хорошо ответы отвечают на исходный запрос?

### **Понимание контекста**

Вы можете оценить, насколько хорошо ваш агент использует предоставленный контекст, например, извлеченные выдержки из источников, факты и статистику, а также сведения о пользователях, добавленные в контекст. Например:

*   **Позиция контекста.** Где появляется контекст в ответах? (Обычно правильная позиция для контекста — вверху.)
*   **Точность контекста.** Сгруппированы ли фрагменты контекста логически? Сохраняет ли ответ исходное значение?
*   **Релевантность контекста.** Использует ли ответ наиболее подходящие части контекста?
*   **Контекстуальное вспоминание.** Полностью ли ответ «вспоминает» предоставленный контекст?

### **Вывод**

Вы можете оценивать, насколько хорошо модель доставляет свой окончательный ответ в соответствии с требованиями к формату, стилю, ясности и соответствию.

*   **Согласованность тона.** Сохраняют ли ответы правильный уровень формальности, технической сложности, эмоционального тона и стиля?
*   **Соответствие промпту.** Следуют ли ответы четким инструкциям, таким как ограничения по длине, обязательные элементы и конкретные требования к форматированию?
*   **Качество суммаризации.** Точно ли ответы сжимают информацию? Рассмотрите, например, сохранение информации, фактическую точность и лаконичность?
*   **Покрытие ключевых слов.** Включает ли ответ технические термины и используемую терминологию?

Другие показатели оценки результатов, такие как определение токсичности и предвзятости, важны, но в основном используются в ведущих моделях.

### **Пример кода**

Вот пример с тремя различными оценочными показателями, которые автоматически проверяют результаты работы агента по написанию контента на точность, соответствие исходному материалу и возможные галлюцинации:

```javascript
import { Agent } from "@mastra/core/agent";
import { openai } from "@ai-sdk/openai";
import {
    FaithfulnessMetric,
    ContentSimilarityMetric,
    HallucinationMetric
} from "@mastra/evals/nlp";

// Configure the agent with the evals array
export const myAgent = new Agent({
    name: "ContentWriter",
    instructions: "You are a content writer that creates accurate summaries",
    model: openai("gpt-4o"),
    evals: [
        new FaithfulnessMetric(), // Checks if output matches source material
        new ContentSimilarityMetric({
            threshold: 0.8 // Require 80% similarity with expected output
        }),
        new HallucinationMetric()
    ],
});
```
